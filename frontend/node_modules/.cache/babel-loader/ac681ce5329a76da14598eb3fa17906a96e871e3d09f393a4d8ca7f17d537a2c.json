{"ast":null,"code":"const axios = require('axios');\nconst cheerio = require('cheerio');\nconst {\n  trace,\n  ROOT_URL,\n  BASE_URL,\n  availableValues,\n  columns,\n  lists,\n  orderMap\n} = require('./constants.js');\n\n/**\n * @typedef {{value: String, name: String}} Genre\n *\n * @typedef {{\n *   sd: Number,\n *   sm: Number,\n *   sy: Number,\n * }} StartDate\n *\n * @typedef {{\n *   ed: Number,\n *   em: Number,\n *   ey: Number,\n * }} EndDate\n *\n * @typedef {{\n *    term: String,\n *    type: Number,\n *    status: Number,\n *    score: Number,\n *    producer: Number,\n *    rating: Number,\n *    startDate: StartDate,\n *    endDate: EndDate,\n *    genreType: Number,\n *    genres: Genre[],\n *    has: Number\n * }} SearchOpts\n */\n\nconst getOrderParams = opts => {\n  const {\n    keys,\n    order = ['DESC', 'DESC']\n  } = opts;\n  if (!Array.isArray(keys) || !Array.isArray(order)) throw new Error('Invalid order parameters.');\n  if (!keys.length) throw new Error('Invalid order keys.');\n  if (order && order.length !== keys.length) throw new Error('Invalid order.');\n  return keys.reduce((acc, key, index) => {\n    const _order = order[index];\n    acc += `o=${encodeURIComponent(orderMap.keys[key])}&w=${encodeURIComponent(orderMap.order[_order])}&`;\n    return acc;\n  }, '?');\n};\nconst getParams = (_type, opts) => {\n  const {\n    term = '',\n    type = 0,\n    status = 0,\n    score = 0,\n    producer = 0,\n    rating = 0,\n    startDate = {},\n    endDate = {},\n    genreType = 0,\n    genres = [],\n    has: after\n  } = opts;\n  if (!availableValues.type.map(({\n    value\n  }) => +value).includes(type)) throw new Error('Invalid Type.');\n  if (!availableValues.status.map(({\n    value\n  }) => +value).includes(status)) throw new Error('Invalid status.');\n  if (_type === 'anime' && !availableValues.r.map(({\n    value\n  }) => +value).includes(rating)) throw new Error('Invalid rating.');\n  if (!availableValues.score.includes(score)) throw new Error('Invalid score.');\n  if (!availableValues.p[_type].map(({\n    value\n  }) => +value).includes(producer)) throw new Error('Invalid producer.');\n  genres.forEach(genre => {\n    if (genre && !availableValues.genre[_type].map(({\n      value\n    }) => +value).includes(genre)) throw new Error('Invalid genre.');\n  });\n  return JSON.parse(JSON.stringify({\n    sd: startDate.day || 0,\n    sm: startDate.month || 0,\n    sy: startDate.year || 0,\n    ed: endDate.day || 0,\n    em: endDate.month || 0,\n    ey: endDate.year || 0,\n    c: ['a', 'b', 'c', 'd', 'e', 'f', 'g'],\n    gx: genreType === 'exclude' ? 1 : 0,\n    q: term,\n    p: producer,\n    r: _type === 'anime' ? rating : undefined,\n    genre: genres,\n    type,\n    status,\n    score,\n    show: typeof after === 'number' ? after : undefined\n  }));\n};\nconst parsePage = (type, $) => {\n  const result = [];\n  const table = $('#content div.list table tbody tr');\n  table.each(function (index) {\n    if (index === 0) return;\n    const entry = {};\n    $(this).find('td').each(function (subIndex) {\n      if (subIndex === 0) {\n        entry.thumbnail = $(this).find('.picSurround > a > img').attr('data-srcset').split(', ')[1].split(' ')[0];\n        return;\n      }\n      if (subIndex === 1) {\n        $(this).find('a').each(function (_i) {\n          if (_i > 1) return;\n          if (_i === 0) entry.url = $(this).attr('href');\n          if (_i === 1) entry.video = $(this).text().trim() !== 'add' ? $(this).attr('href') : null;\n        });\n        entry.shortDescription = $(this).children().last().text();\n        entry.title = $(this).find('a strong').text().trim();\n        return;\n      }\n      entry[columns[type][subIndex]] = $(this).text().trim();\n    });\n    result.push(entry);\n  });\n  return result;\n};\nconst hasNext = $ => {\n  // This should be like\n  // [1] <a href=\"...\">2</a> <a href=\"...\">3</a> ... <a href=\"...\">20</a>\n  const anchor = $('#content > div.normal_header > div').find('span');\n\n  // If last character is a closing bracket, it means that the current page is at the end.\n  const hasNext = anchor.text().slice(-1) !== ']';\n  let nextUrl = null;\n  if (hasNext) {\n    // Looking for the current page which is between brackets\n    const currentPageNumber = anchor.text().match(/\\[\\d+\\]/);\n    if (currentPageNumber.length) {\n      // Removing brackets and adding one to find next page\n      const nextPageNumber = +currentPageNumber[0].slice(1, -1) + 1;\n\n      // href is a patial URI missing the website URL.\n      nextUrl = ROOT_URL + anchor.find(`a:contains(${nextPageNumber})`).attr('href');\n    }\n  }\n  return {\n    hasNext,\n    nextUrl\n  };\n};\nconst getResults = (type, url, params = {}, maxResult = 50, result = []) => {\n  return new Promise((resolve, reject) => {\n    axios.get(url, {\n      params\n    }).then(res => {\n      const {\n        data\n      } = res;\n      const $ = cheerio.load(data);\n      const next = hasNext($);\n      const _result = [...result, ...parsePage(type, $)];\n      resolve(_result.length < maxResult && next.hasNext ? getResults(type, next.nextUrl, {}, maxResult, _result) : _result);\n    }).catch(reject);\n  });\n};\n\n/**\n * Makes a search request based on:\n *  -- https://myanimelist.net/anime.php\n *  -- https://myanimelist.net/manga.php\n *\n * @param {String} type anime | manga\n * @param {SearchOpts} opts\n */\nconst search = (type, opts) => {\n  const params = getParams(type, opts);\n  const order = opts.order && getOrderParams(opts.order);\n  return getResults(type, BASE_URL.replace(trace, type) + (order || ''), params, opts.maxResults);\n};\nmodule.exports = {\n  search,\n  helpers: {\n    availableValues,\n    producersList: lists.producers,\n    genresList: lists.genres,\n    orderTypes: Object.keys(orderMap.keys)\n  }\n};","map":{"version":3,"names":["axios","require","cheerio","trace","ROOT_URL","BASE_URL","availableValues","columns","lists","orderMap","getOrderParams","opts","keys","order","Array","isArray","Error","length","reduce","acc","key","index","_order","encodeURIComponent","getParams","_type","term","type","status","score","producer","rating","startDate","endDate","genreType","genres","has","after","map","value","includes","r","p","forEach","genre","JSON","parse","stringify","sd","day","sm","month","sy","year","ed","em","ey","c","gx","q","undefined","show","parsePage","$","result","table","each","entry","find","subIndex","thumbnail","attr","split","_i","url","video","text","trim","shortDescription","children","last","title","push","hasNext","anchor","slice","nextUrl","currentPageNumber","match","nextPageNumber","getResults","params","maxResult","Promise","resolve","reject","get","then","res","data","load","next","_result","catch","search","replace","maxResults","module","exports","helpers","producersList","producers","genresList","orderTypes","Object"],"sources":["C:/Users/elric/Desktop/reactsql/frontend/node_modules/mal-scraper/src/search/index.js"],"sourcesContent":["const axios = require('axios')\nconst cheerio = require('cheerio')\n\nconst {\n  trace,\n  ROOT_URL,\n  BASE_URL,\n  availableValues,\n  columns,\n  lists,\n  orderMap\n} = require('./constants.js')\n\n/**\n * @typedef {{value: String, name: String}} Genre\n *\n * @typedef {{\n *   sd: Number,\n *   sm: Number,\n *   sy: Number,\n * }} StartDate\n *\n * @typedef {{\n *   ed: Number,\n *   em: Number,\n *   ey: Number,\n * }} EndDate\n *\n * @typedef {{\n *    term: String,\n *    type: Number,\n *    status: Number,\n *    score: Number,\n *    producer: Number,\n *    rating: Number,\n *    startDate: StartDate,\n *    endDate: EndDate,\n *    genreType: Number,\n *    genres: Genre[],\n *    has: Number\n * }} SearchOpts\n */\n\nconst getOrderParams = (opts) => {\n  const { keys, order = ['DESC', 'DESC'] } = opts\n\n  if (!Array.isArray(keys) || !Array.isArray(order)) throw new Error('Invalid order parameters.')\n  if (!keys.length) throw new Error('Invalid order keys.')\n  if (order && order.length !== keys.length) throw new Error('Invalid order.')\n\n  return keys.reduce((acc, key, index) => {\n    const _order = order[index]\n\n    acc += `o=${encodeURIComponent(orderMap.keys[key])}&w=${encodeURIComponent(orderMap.order[_order])}&`\n\n    return acc\n  }, '?')\n}\n\nconst getParams = (_type, opts) => {\n  const {\n    term = '',\n    type = 0,\n    status = 0,\n    score = 0,\n    producer = 0,\n    rating = 0,\n    startDate = {},\n    endDate = {},\n    genreType = 0,\n    genres = [],\n    has: after\n  } = opts\n\n  if (!availableValues.type.map(({ value }) => +value).includes(type)) throw new Error('Invalid Type.')\n  if (!availableValues.status.map(({ value }) => +value).includes(status)) throw new Error('Invalid status.')\n  if (_type === 'anime' && !availableValues.r.map(({ value }) => +value).includes(rating)) throw new Error('Invalid rating.')\n\n  if (!availableValues.score.includes(score)) throw new Error('Invalid score.')\n\n  if (!availableValues.p[_type].map(({ value }) => +value).includes(producer)) throw new Error('Invalid producer.')\n\n  genres.forEach((genre) => {\n    if (genre && !availableValues.genre[_type].map(({ value }) => +value).includes(genre)) throw new Error('Invalid genre.')\n  })\n\n  return JSON.parse(JSON.stringify({\n    sd: startDate.day || 0,\n    sm: startDate.month || 0,\n    sy: startDate.year || 0,\n    ed: endDate.day || 0,\n    em: endDate.month || 0,\n    ey: endDate.year || 0,\n\n    c: ['a', 'b', 'c', 'd', 'e', 'f', 'g'],\n\n    gx: genreType === 'exclude' ? 1 : 0,\n\n    q: term,\n    p: producer,\n    r: _type === 'anime' ? rating : undefined,\n\n    genre: genres,\n    type,\n    status,\n    score,\n\n    show: typeof after === 'number' ? after : undefined\n  }))\n}\n\nconst parsePage = (type, $) => {\n  const result = []\n  const table = $('#content div.list table tbody tr')\n\n  table.each(function (index) {\n    if (index === 0) return\n\n    const entry = {}\n\n    $(this).find('td').each(function (subIndex) {\n      if (subIndex === 0) {\n        entry.thumbnail = $(this).find('.picSurround > a > img').attr('data-srcset').split(', ')[1].split(' ')[0]\n        return\n      }\n\n      if (subIndex === 1) {\n        $(this).find('a').each(function (_i) {\n          if (_i > 1) return\n\n          if (_i === 0) entry.url = $(this).attr('href')\n          if (_i === 1) entry.video = $(this).text().trim() !== 'add' ? $(this).attr('href') : null\n        })\n\n        entry.shortDescription = $(this).children().last().text()\n\n        entry.title = $(this).find('a strong').text().trim()\n\n        return\n      }\n\n      entry[columns[type][subIndex]] = $(this).text().trim()\n    })\n\n    result.push(entry)\n  })\n\n  return result\n}\n\nconst hasNext = ($) => {\n  // This should be like\n  // [1] <a href=\"...\">2</a> <a href=\"...\">3</a> ... <a href=\"...\">20</a>\n  const anchor = $('#content > div.normal_header > div').find('span')\n\n  // If last character is a closing bracket, it means that the current page is at the end.\n  const hasNext = anchor.text().slice(-1) !== ']'\n  let nextUrl = null\n\n  if (hasNext) {\n    // Looking for the current page which is between brackets\n    const currentPageNumber = anchor.text().match(/\\[\\d+\\]/)\n\n    if (currentPageNumber.length) {\n      // Removing brackets and adding one to find next page\n      const nextPageNumber = +currentPageNumber[0].slice(1, -1) + 1\n\n      // href is a patial URI missing the website URL.\n      nextUrl = ROOT_URL + anchor.find(`a:contains(${nextPageNumber})`).attr('href')\n    }\n  }\n\n  return { hasNext, nextUrl }\n}\n\nconst getResults = (type, url, params = {}, maxResult = 50, result = []) => {\n  return new Promise((resolve, reject) => {\n    axios.get(url, { params })\n      .then((res) => {\n        const { data } = res\n        const $ = cheerio.load(data)\n        const next = hasNext($)\n        const _result = [...result, ...parsePage(type, $)]\n\n        resolve(\n          _result.length < maxResult && next.hasNext\n            ? getResults(type, next.nextUrl, {}, maxResult, _result)\n            : _result\n        )\n      })\n      .catch(reject)\n  })\n}\n\n/**\n * Makes a search request based on:\n *  -- https://myanimelist.net/anime.php\n *  -- https://myanimelist.net/manga.php\n *\n * @param {String} type anime | manga\n * @param {SearchOpts} opts\n */\nconst search = (type, opts) => {\n  const params = getParams(type, opts)\n  const order = opts.order && getOrderParams(opts.order)\n\n  return getResults(\n    type,\n    BASE_URL.replace(trace, type) + (order || ''),\n    params, opts.maxResults\n  )\n}\n\nmodule.exports = {\n  search,\n  helpers: {\n    availableValues,\n    producersList: lists.producers,\n    genresList: lists.genres,\n    orderTypes: Object.keys(orderMap.keys)\n  }\n}\n"],"mappings":"AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAO,CAAC;AAC9B,MAAMC,OAAO,GAAGD,OAAO,CAAC,SAAS,CAAC;AAElC,MAAM;EACJE,KAAK;EACLC,QAAQ;EACRC,QAAQ;EACRC,eAAe;EACfC,OAAO;EACPC,KAAK;EACLC;AACF,CAAC,GAAGR,OAAO,CAAC,gBAAgB,CAAC;;AAE7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAMS,cAAc,GAAIC,IAAI,IAAK;EAC/B,MAAM;IAAEC,IAAI;IAAEC,KAAK,GAAG,CAAC,MAAM,EAAE,MAAM;EAAE,CAAC,GAAGF,IAAI;EAE/C,IAAI,CAACG,KAAK,CAACC,OAAO,CAACH,IAAI,CAAC,IAAI,CAACE,KAAK,CAACC,OAAO,CAACF,KAAK,CAAC,EAAE,MAAM,IAAIG,KAAK,CAAC,2BAA2B,CAAC;EAC/F,IAAI,CAACJ,IAAI,CAACK,MAAM,EAAE,MAAM,IAAID,KAAK,CAAC,qBAAqB,CAAC;EACxD,IAAIH,KAAK,IAAIA,KAAK,CAACI,MAAM,KAAKL,IAAI,CAACK,MAAM,EAAE,MAAM,IAAID,KAAK,CAAC,gBAAgB,CAAC;EAE5E,OAAOJ,IAAI,CAACM,MAAM,CAAC,CAACC,GAAG,EAAEC,GAAG,EAAEC,KAAK,KAAK;IACtC,MAAMC,MAAM,GAAGT,KAAK,CAACQ,KAAK,CAAC;IAE3BF,GAAG,IAAK,KAAII,kBAAkB,CAACd,QAAQ,CAACG,IAAI,CAACQ,GAAG,CAAC,CAAE,MAAKG,kBAAkB,CAACd,QAAQ,CAACI,KAAK,CAACS,MAAM,CAAC,CAAE,GAAE;IAErG,OAAOH,GAAG;EACZ,CAAC,EAAE,GAAG,CAAC;AACT,CAAC;AAED,MAAMK,SAAS,GAAGA,CAACC,KAAK,EAAEd,IAAI,KAAK;EACjC,MAAM;IACJe,IAAI,GAAG,EAAE;IACTC,IAAI,GAAG,CAAC;IACRC,MAAM,GAAG,CAAC;IACVC,KAAK,GAAG,CAAC;IACTC,QAAQ,GAAG,CAAC;IACZC,MAAM,GAAG,CAAC;IACVC,SAAS,GAAG,CAAC,CAAC;IACdC,OAAO,GAAG,CAAC,CAAC;IACZC,SAAS,GAAG,CAAC;IACbC,MAAM,GAAG,EAAE;IACXC,GAAG,EAAEC;EACP,CAAC,GAAG1B,IAAI;EAER,IAAI,CAACL,eAAe,CAACqB,IAAI,CAACW,GAAG,CAAC,CAAC;IAAEC;EAAM,CAAC,KAAK,CAACA,KAAK,CAAC,CAACC,QAAQ,CAACb,IAAI,CAAC,EAAE,MAAM,IAAIX,KAAK,CAAC,eAAe,CAAC;EACrG,IAAI,CAACV,eAAe,CAACsB,MAAM,CAACU,GAAG,CAAC,CAAC;IAAEC;EAAM,CAAC,KAAK,CAACA,KAAK,CAAC,CAACC,QAAQ,CAACZ,MAAM,CAAC,EAAE,MAAM,IAAIZ,KAAK,CAAC,iBAAiB,CAAC;EAC3G,IAAIS,KAAK,KAAK,OAAO,IAAI,CAACnB,eAAe,CAACmC,CAAC,CAACH,GAAG,CAAC,CAAC;IAAEC;EAAM,CAAC,KAAK,CAACA,KAAK,CAAC,CAACC,QAAQ,CAACT,MAAM,CAAC,EAAE,MAAM,IAAIf,KAAK,CAAC,iBAAiB,CAAC;EAE3H,IAAI,CAACV,eAAe,CAACuB,KAAK,CAACW,QAAQ,CAACX,KAAK,CAAC,EAAE,MAAM,IAAIb,KAAK,CAAC,gBAAgB,CAAC;EAE7E,IAAI,CAACV,eAAe,CAACoC,CAAC,CAACjB,KAAK,CAAC,CAACa,GAAG,CAAC,CAAC;IAAEC;EAAM,CAAC,KAAK,CAACA,KAAK,CAAC,CAACC,QAAQ,CAACV,QAAQ,CAAC,EAAE,MAAM,IAAId,KAAK,CAAC,mBAAmB,CAAC;EAEjHmB,MAAM,CAACQ,OAAO,CAAEC,KAAK,IAAK;IACxB,IAAIA,KAAK,IAAI,CAACtC,eAAe,CAACsC,KAAK,CAACnB,KAAK,CAAC,CAACa,GAAG,CAAC,CAAC;MAAEC;IAAM,CAAC,KAAK,CAACA,KAAK,CAAC,CAACC,QAAQ,CAACI,KAAK,CAAC,EAAE,MAAM,IAAI5B,KAAK,CAAC,gBAAgB,CAAC;EAC1H,CAAC,CAAC;EAEF,OAAO6B,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAC;IAC/BC,EAAE,EAAEhB,SAAS,CAACiB,GAAG,IAAI,CAAC;IACtBC,EAAE,EAAElB,SAAS,CAACmB,KAAK,IAAI,CAAC;IACxBC,EAAE,EAAEpB,SAAS,CAACqB,IAAI,IAAI,CAAC;IACvBC,EAAE,EAAErB,OAAO,CAACgB,GAAG,IAAI,CAAC;IACpBM,EAAE,EAAEtB,OAAO,CAACkB,KAAK,IAAI,CAAC;IACtBK,EAAE,EAAEvB,OAAO,CAACoB,IAAI,IAAI,CAAC;IAErBI,CAAC,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;IAEtCC,EAAE,EAAExB,SAAS,KAAK,SAAS,GAAG,CAAC,GAAG,CAAC;IAEnCyB,CAAC,EAAEjC,IAAI;IACPgB,CAAC,EAAEZ,QAAQ;IACXW,CAAC,EAAEhB,KAAK,KAAK,OAAO,GAAGM,MAAM,GAAG6B,SAAS;IAEzChB,KAAK,EAAET,MAAM;IACbR,IAAI;IACJC,MAAM;IACNC,KAAK;IAELgC,IAAI,EAAE,OAAOxB,KAAK,KAAK,QAAQ,GAAGA,KAAK,GAAGuB;EAC5C,CAAC,CAAC,CAAC;AACL,CAAC;AAED,MAAME,SAAS,GAAGA,CAACnC,IAAI,EAAEoC,CAAC,KAAK;EAC7B,MAAMC,MAAM,GAAG,EAAE;EACjB,MAAMC,KAAK,GAAGF,CAAC,CAAC,kCAAkC,CAAC;EAEnDE,KAAK,CAACC,IAAI,CAAC,UAAU7C,KAAK,EAAE;IAC1B,IAAIA,KAAK,KAAK,CAAC,EAAE;IAEjB,MAAM8C,KAAK,GAAG,CAAC,CAAC;IAEhBJ,CAAC,CAAC,IAAI,CAAC,CAACK,IAAI,CAAC,IAAI,CAAC,CAACF,IAAI,CAAC,UAAUG,QAAQ,EAAE;MAC1C,IAAIA,QAAQ,KAAK,CAAC,EAAE;QAClBF,KAAK,CAACG,SAAS,GAAGP,CAAC,CAAC,IAAI,CAAC,CAACK,IAAI,CAAC,wBAAwB,CAAC,CAACG,IAAI,CAAC,aAAa,CAAC,CAACC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAACA,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QACzG;MACF;MAEA,IAAIH,QAAQ,KAAK,CAAC,EAAE;QAClBN,CAAC,CAAC,IAAI,CAAC,CAACK,IAAI,CAAC,GAAG,CAAC,CAACF,IAAI,CAAC,UAAUO,EAAE,EAAE;UACnC,IAAIA,EAAE,GAAG,CAAC,EAAE;UAEZ,IAAIA,EAAE,KAAK,CAAC,EAAEN,KAAK,CAACO,GAAG,GAAGX,CAAC,CAAC,IAAI,CAAC,CAACQ,IAAI,CAAC,MAAM,CAAC;UAC9C,IAAIE,EAAE,KAAK,CAAC,EAAEN,KAAK,CAACQ,KAAK,GAAGZ,CAAC,CAAC,IAAI,CAAC,CAACa,IAAI,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,KAAK,KAAK,GAAGd,CAAC,CAAC,IAAI,CAAC,CAACQ,IAAI,CAAC,MAAM,CAAC,GAAG,IAAI;QAC3F,CAAC,CAAC;QAEFJ,KAAK,CAACW,gBAAgB,GAAGf,CAAC,CAAC,IAAI,CAAC,CAACgB,QAAQ,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAACJ,IAAI,CAAC,CAAC;QAEzDT,KAAK,CAACc,KAAK,GAAGlB,CAAC,CAAC,IAAI,CAAC,CAACK,IAAI,CAAC,UAAU,CAAC,CAACQ,IAAI,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;QAEpD;MACF;MAEAV,KAAK,CAAC5D,OAAO,CAACoB,IAAI,CAAC,CAAC0C,QAAQ,CAAC,CAAC,GAAGN,CAAC,CAAC,IAAI,CAAC,CAACa,IAAI,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;IACxD,CAAC,CAAC;IAEFb,MAAM,CAACkB,IAAI,CAACf,KAAK,CAAC;EACpB,CAAC,CAAC;EAEF,OAAOH,MAAM;AACf,CAAC;AAED,MAAMmB,OAAO,GAAIpB,CAAC,IAAK;EACrB;EACA;EACA,MAAMqB,MAAM,GAAGrB,CAAC,CAAC,oCAAoC,CAAC,CAACK,IAAI,CAAC,MAAM,CAAC;;EAEnE;EACA,MAAMe,OAAO,GAAGC,MAAM,CAACR,IAAI,CAAC,CAAC,CAACS,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG;EAC/C,IAAIC,OAAO,GAAG,IAAI;EAElB,IAAIH,OAAO,EAAE;IACX;IACA,MAAMI,iBAAiB,GAAGH,MAAM,CAACR,IAAI,CAAC,CAAC,CAACY,KAAK,CAAC,SAAS,CAAC;IAExD,IAAID,iBAAiB,CAACtE,MAAM,EAAE;MAC5B;MACA,MAAMwE,cAAc,GAAG,CAACF,iBAAiB,CAAC,CAAC,CAAC,CAACF,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC;;MAE7D;MACAC,OAAO,GAAGlF,QAAQ,GAAGgF,MAAM,CAAChB,IAAI,CAAE,cAAaqB,cAAe,GAAE,CAAC,CAAClB,IAAI,CAAC,MAAM,CAAC;IAChF;EACF;EAEA,OAAO;IAAEY,OAAO;IAAEG;EAAQ,CAAC;AAC7B,CAAC;AAED,MAAMI,UAAU,GAAGA,CAAC/D,IAAI,EAAE+C,GAAG,EAAEiB,MAAM,GAAG,CAAC,CAAC,EAAEC,SAAS,GAAG,EAAE,EAAE5B,MAAM,GAAG,EAAE,KAAK;EAC1E,OAAO,IAAI6B,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtC/F,KAAK,CAACgG,GAAG,CAACtB,GAAG,EAAE;MAAEiB;IAAO,CAAC,CAAC,CACvBM,IAAI,CAAEC,GAAG,IAAK;MACb,MAAM;QAAEC;MAAK,CAAC,GAAGD,GAAG;MACpB,MAAMnC,CAAC,GAAG7D,OAAO,CAACkG,IAAI,CAACD,IAAI,CAAC;MAC5B,MAAME,IAAI,GAAGlB,OAAO,CAACpB,CAAC,CAAC;MACvB,MAAMuC,OAAO,GAAG,CAAC,GAAGtC,MAAM,EAAE,GAAGF,SAAS,CAACnC,IAAI,EAAEoC,CAAC,CAAC,CAAC;MAElD+B,OAAO,CACLQ,OAAO,CAACrF,MAAM,GAAG2E,SAAS,IAAIS,IAAI,CAAClB,OAAO,GACtCO,UAAU,CAAC/D,IAAI,EAAE0E,IAAI,CAACf,OAAO,EAAE,CAAC,CAAC,EAAEM,SAAS,EAAEU,OAAO,CAAC,GACtDA,OACN,CAAC;IACH,CAAC,CAAC,CACDC,KAAK,CAACR,MAAM,CAAC;EAClB,CAAC,CAAC;AACJ,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMS,MAAM,GAAGA,CAAC7E,IAAI,EAAEhB,IAAI,KAAK;EAC7B,MAAMgF,MAAM,GAAGnE,SAAS,CAACG,IAAI,EAAEhB,IAAI,CAAC;EACpC,MAAME,KAAK,GAAGF,IAAI,CAACE,KAAK,IAAIH,cAAc,CAACC,IAAI,CAACE,KAAK,CAAC;EAEtD,OAAO6E,UAAU,CACf/D,IAAI,EACJtB,QAAQ,CAACoG,OAAO,CAACtG,KAAK,EAAEwB,IAAI,CAAC,IAAId,KAAK,IAAI,EAAE,CAAC,EAC7C8E,MAAM,EAAEhF,IAAI,CAAC+F,UACf,CAAC;AACH,CAAC;AAEDC,MAAM,CAACC,OAAO,GAAG;EACfJ,MAAM;EACNK,OAAO,EAAE;IACPvG,eAAe;IACfwG,aAAa,EAAEtG,KAAK,CAACuG,SAAS;IAC9BC,UAAU,EAAExG,KAAK,CAAC2B,MAAM;IACxB8E,UAAU,EAAEC,MAAM,CAACtG,IAAI,CAACH,QAAQ,CAACG,IAAI;EACvC;AACF,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}